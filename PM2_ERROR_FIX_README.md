# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï PM2 –û–®–ò–ë–ö–ò (ERRORED)

## ‚ùå –ü–†–û–ë–õ–ï–ú–ê
PM2 –ø—Ä–æ—Ü–µ—Å—Å `ruplatform-backend` –≤ —Å—Ç–∞—Ç—É—Å–µ "errored":
```
‚îÇ 0  ‚îÇ ruplatform-backend ‚îÇ fork     ‚îÇ 15   ‚îÇ errored   ‚îÇ 0%       ‚îÇ 0b       ‚îÇ
```

## üîç –ü–†–ò–ß–ò–ù–´
1. **–°–±–æ—Ä–∫–∞ backend –Ω–µ —É–¥–∞–ª–∞—Å—å** - TypeScript –æ—à–∏–±–∫–∏
2. **–§–∞–π–ª—ã –Ω–µ —Å–æ–∑–¥–∞–Ω—ã** - dist/index.js –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
3. **–ü–æ—Ä—Ç 3000 –∑–∞–Ω—è—Ç** - –¥—Ä—É–≥–æ–π –ø—Ä–æ—Ü–µ—Å—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç
4. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** - .env —Ñ–∞–π–ª –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
5. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞** - –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

## ‚ö° –ù–ï–ú–ï–î–õ–ï–ù–ù–û–ï –†–ï–®–ï–ù–ò–ï

### –®–ê–ì 1: –ó–ê–ü–£–°–¢–ò–¢–ï –î–ò–ê–ì–ù–û–°–¢–ò–ö–£ PM2
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
wget https://raw.githubusercontent.com/your-repo/diagnose-pm2-error.sh
chmod +x diagnose-pm2-error.sh
sudo ./diagnose-pm2-error.sh
```

### –®–ê–ì 2: –ü–†–û–í–ï–†–¨–¢–ï –†–ï–ó–£–õ–¨–¢–ê–¢
```bash
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
# ‚úÖ dist/index.js —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
# ‚úÖ –ü–æ—Ä—Ç 3000 —Å–≤–æ–±–æ–¥–µ–Ω
# ‚úÖ .env —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω
# ‚úÖ Backend —Å–æ–±—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ
# ‚úÖ PM2 –∑–∞–ø—É—â–µ–Ω
# ‚úÖ API –æ—Ç–≤–µ—á–∞–µ—Ç 200 OK
```

## üîß –†–£–ß–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PM2:
```bash
pm2 logs ruplatform-backend --lines 50
# –ü–æ–∫–∞–∂–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –æ—à–∏–±–∫—É
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç:
```bash
ls -la /home/node/ruplatform/server/dist/
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: index.js –∏ –¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç 3000:
```bash
netstat -tlnp | grep ":3000"
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: –Ω–∏—á–µ–≥–æ (–ø–æ—Ä—Ç —Å–≤–æ–±–æ–¥–µ–Ω)
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª:
```bash
cat /home/node/ruplatform/server/.env
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: PORT=3000
```

## üîç –ü–û–î–†–û–ë–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –ï—Å–ª–∏ dist/index.js –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:
```bash
cd /home/node/ruplatform/server
npm run build
# –î–æ–ª–∂–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è —É—Å–ø–µ—à–Ω–æ
```

### –ï—Å–ª–∏ –ø–æ—Ä—Ç 3000 –∑–∞–Ω—è—Ç:
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pm2 stop all && pm2 delete all && pm2 kill
pkill -9 node && pkill -9 -f "3000"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ—Ä—Ç —Å–≤–æ–±–æ–¥–µ–Ω
netstat -tlnp | grep ":3000"
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: –Ω–∏—á–µ–≥–æ
```

### –ï—Å–ª–∏ .env —Ñ–∞–π–ª –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:
```bash
cd /home/node/ruplatform/server
echo "PORT=3000" > .env
```

### –ï—Å–ª–∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ:
```bash
sudo chown -R node:node /home/node/ruplatform/server/
sudo chmod -R 755 /home/node/ruplatform/server/
```

## üß™ –ü–†–û–í–ï–†–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–ê

### –í –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞:
```bash
# ‚úÖ –î–û–õ–ñ–ù–´ –†–ê–ë–û–¢–ê–¢–¨:
‚úì pm2 status - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç online
‚úì ls -la server/dist/index.js - —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
‚úì netstat -tlnp | grep ":3000" - –ø–æ—Ä—Ç —Å–≤–æ–±–æ–¥–µ–Ω
‚úì cat server/.env - PORT=3000
‚úì curl -I http://localhost:3000/api/experts/1 - 200 OK
```

### –í –±—Ä–∞—É–∑–µ—Ä–µ (Network):
```javascript
// ‚úÖ –î–û–õ–ñ–ù–´ –†–ê–ë–û–¢–ê–¢–¨:
‚úì https://soulsynergy.ru/api/experts/1 200 OK
‚úì https://soulsynergy.ru/api/users/cities 200 OK
‚úì https://soulsynergy.ru/api/experts/search 200 OK

// ‚ùå –ù–ï –î–û–õ–ñ–ù–û –ë–´–¢–¨:
‚úó 404 Not Found
‚úó Connection refused
‚úó PM2 errored
```

### –í –±—Ä–∞—É–∑–µ—Ä–µ (Console):
```javascript
// ‚úÖ –î–û–õ–ñ–ù–´ –†–ê–ë–û–¢–ê–¢–¨:
‚úì "–°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞ —Å —ç–∫—Å–ø–µ—Ä—Ç–æ–º: ..."
‚úì "–ß–∞—Ç —Å–æ–∑–¥–∞–Ω: {chatId: 123}"
‚úì "–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —á–∞—Ç—É: 123"

// ‚ùå –ù–ï –î–û–õ–ñ–ù–û –ë–´–¢–¨:
‚úó "ID —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω"
‚úó "Request failed with status code 400"
‚úó –û—à–∏–±–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–∞
```

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

‚úÖ **Backend —Å–æ–±—Ä–∞–Ω** - dist/index.js —Å–æ–∑–¥–∞–Ω
‚úÖ **–ü–æ—Ä—Ç 3000 —Å–≤–æ–±–æ–¥–µ–Ω** - –Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
‚úÖ **PM2 –∑–∞–ø—É—â–µ–Ω** - –ø—Ä–æ—Ü–µ—Å—Å online
‚úÖ **API –æ—Ç–≤–µ—á–∞–µ—Ç 200 OK** - –≤—Å–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç
‚úÖ **–í –±—Ä–∞—É–∑–µ—Ä–µ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –ø—Ä–æ—Ñ–∏–ª—å, —á–∞—Ç, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É - PM2 –æ—à–∏–±–∫–∞ –∏—Å—á–µ–∑–Ω–µ—Ç!** üöÄ
