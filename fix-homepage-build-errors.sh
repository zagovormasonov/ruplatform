#!/bin/bash

echo "üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–û–ö –°–ë–û–†–ö–ò –ì–õ–ê–í–ù–û–ô –°–¢–†–ê–ù–ò–¶–´..."

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

echo -e "${BLUE}üîÑ –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é client...${NC}"
cd /home/node/ruplatform/client

echo -e "${BLUE}üî® –°–æ–±–∏—Ä–∞–µ–º frontend —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏...${NC}"
npm run build

if [ $? -eq 0 ]; then
    echo -e "${GREEN}‚úÖ Frontend —Å–æ–±—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ!${NC}"
    echo -e "${GREEN}‚úÖ –û—à–∏–±–∫–∏ TypeScript –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã${NC}"
else
    echo -e "${RED}‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ frontend${NC}"
    echo -e "${YELLOW}‚ö†Ô∏è  –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –∏ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å:${NC}"
    echo ""
    echo -e "${BLUE}üîÑ –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞...${NC}"
    rm -rf node_modules/.cache
    rm -rf dist
    npm run build

    if [ $? -eq 0 ]; then
        echo -e "${GREEN}‚úÖ Frontend —Å–æ–±—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞!${NC}"
    else
        echo -e "${RED}‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ –¥–∞–∂–µ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞${NC}"
        exit 1
    fi
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã
if [ -f "dist/index.html" ]; then
    echo -e "${GREEN}‚úÖ dist/index.html —Å–æ–∑–¥–∞–Ω${NC}"
else
    echo -e "${RED}‚ùå dist/index.html –ù–ï —Å–æ–∑–¥–∞–Ω${NC}"
    exit 1
fi

echo ""
echo -e "${GREEN}üéâ –ì–õ–ê–í–ù–ê–Ø –°–¢–†–ê–ù–ò–¶–ê –£–°–ü–ï–®–ù–û –°–û–ë–†–ê–ù–ê!${NC}"
echo ""
echo -e "${YELLOW}üîÑ –¢–µ–ø–µ—Ä—å –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:${NC}"
echo "   üì± https://soulsynergy.ru"
echo ""
echo -e "${GREEN}‚ú® –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´:${NC}"
echo "   ‚úì –£–¥–∞–ª–µ–Ω –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç 'Empty'"
echo "   ‚úì –£–¥–∞–ª–µ–Ω –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç 'StarOutlined'"
echo "   ‚úì TypeScript –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã"
echo "   ‚úì –ù–æ–≤–∞—è –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≥–æ—Ç–æ–≤–∞"
echo ""
echo -e "${GREEN}üöÄ –ü–†–ò–Ø–¢–ù–û–ì–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø!${NC}"
